version: "v1.0"
name: First pipeline example
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804

blocks:
  - name: "List by date and store all the things"
    task:
      jobs:
      - name: Cache repository
        commands:
          - checkout
          - echo $SEMAPHORE_GIT_REPO_NAME
          - cd - && cache store repository-$SEMAPHORE_WORKFLOW_ID base-app-caching-example

  - name: "Utilize cache"
    task:
      jobs:
      - name: Tests
        commands:
          - cache list
          - env
          - cache restore repository-$SEMAPHORE_WORKFLOW_ID
          - checkout
          - env
          - ls
      - name: Docker
        commands:
          - cache list
          - cache restore repository-$SEMAPHORE_WORKFLOW_ID
          - checkout
          - pwd
